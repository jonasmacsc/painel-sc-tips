<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <!-- ===== HEAD / META ===== -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üõ∞Ô∏è FASCOR ‚Ä¢ Puxadores Live ‚Äî SC TIPS</title>
  <meta name="theme-color" content="#0b0a05">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16.png">
  <link rel="manifest" href="assets/favicon/site.webmanifest">

  <!-- ===== THEME / CSS (FASCOR) ===== -->
  <style>
    :root{
      --bg:#070804; --panel:#0b0f08; --panel2:#0e130b; --stroke:#2a2b1a;
      --ink:#f8ffe9; --muted:#d8e9a0;
      --gold:#f7d253; --gold-deep:#c2972a; --gold-neon:#fff06a;
      --glow:0 0 10px rgba(255,240,106,.45),0 0 24px rgba(247,210,83,.35);
      --glow-strong:0 0 14px rgba(255,240,106,.7),0 0 36px rgba(247,210,83,.6);
      --ok:#2ad17f; --err:#ff6464; --warn:#ffd24d;
      --chip-green:#00d37e; --chip-red:#ff5a5a; --chip-black:#6fe0ff;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{background:var(--bg);color:var(--ink);font:16px/1.5 Inter,Segoe UI,system-ui,sans-serif}
    a{color:var(--gold-neon);text-decoration:none}

    /* NAVBAR */
    nav{position:sticky;top:0;z-index:10;background:linear-gradient(180deg,rgba(15,17,10,.9),rgba(10,11,6,.9));border-bottom:1px solid #3a361c;box-shadow:var(--glow)}
    nav .row{display:flex;align-items:center;justify-content:space-between;padding:12px 18px}
    .brand{display:flex;align-items:center;gap:10px;text-shadow:var(--glow)}
    .brand video{width:42px;height:42px;border-radius:10px;object-fit:cover;background:#000;box-shadow:var(--glow)}
    .brand b{font-weight:900;letter-spacing:.3px;color:var(--gold-neon)}
    .brand small{border:1px solid #3a361c;padding:2px 8px;border-radius:999px;color:#13140a;background:#0b0d07}
    .menu{display:flex;gap:8px;flex-wrap:wrap}
    .menu a{padding:8px 14px;border-radius:10px;color:#eee9c9;border:1px solid #3a361c;background:#0b0d07}
    .menu a:hover{box-shadow:var(--glow)}
    .menu a.active{background:linear-gradient(135deg,var(--gold-neon),var(--gold));color:#161305;font-weight:800;border:0;box-shadow:var(--glow-strong)}

    .wrap{max-width:1240px;margin:0 auto;padding:18px}
    h1{font-size:30px;margin:14px 0 10px;font-weight:900;color:var(--gold-neon);text-shadow:var(--glow)}
    h2{font-size:18px;margin:8px 0 12px;color:var(--muted);font-weight:700}
    h3{margin:14px 0 10px;font-weight:800;color:var(--gold);text-shadow:var(--glow)}

    .grid{display:grid;gap:16px}
    @media(min-width:1100px){.grid{grid-template-columns:1.2fr 1fr}}

    .card{background:linear-gradient(180deg,#0f1209,#0b0f08);border:1px solid #3a361c;padding:14px;border-radius:16px;box-shadow:inset 0 0 0 1px rgba(255,240,106,.08),var(--glow)}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

    /* Bot√µes */
    .btn{padding:10px 14px;border-radius:12px;cursor:pointer;color:#13120a;border:0;font-weight:800;letter-spacing:.3px;background:linear-gradient(180deg,var(--gold-neon),var(--gold));box-shadow:var(--glow)}
    .btn:hover{filter:brightness(1.05);box-shadow:var(--glow-strong)}
    .btn.ghost{color:#efeacd;background:#0b0d07;border:1px solid #3a361c;box-shadow:var(--glow)}
    .btn.small{padding:6px 10px;font-size:14px}
    .btn.dark{color:#efeacd;background:#121406;border:1px solid #3a361c}

    /* Console */
    .console{background:#0a0d07;border:1px solid #3a361c;padding:12px;border-radius:16px;margin:16px 0;box-shadow:var(--glow)}
    .loglist{background:#0a0c06;border:1px solid #2d2a15;border-radius:12px;height:260px;overflow:auto;padding:8px}
    .log{margin:6px 0;padding:8px 10px;border-radius:10px;font-size:14px}
    .hit{background:rgba(42,209,127,.08);border:1px solid #2ad17f}
    .miss{background:rgba(255,100,100,.08);border:1px solid #ff6464}
    .sys{background:rgba(255,240,106,.06);border:1px solid #7a6b1b}
    .warn{background:rgba(255,210,77,.08);border:1px solid #b4931f}
    input[type="text"],input[type="number"],input[type="url"]{background:#0b0d07;border:1px solid #3a361c;color:#efeacd;border-radius:12px;padding:10px 12px;outline:none;min-width:180px;box-shadow:var(--glow)}
    .pill{display:inline-flex;align-items:center;gap:8px;background:#0b0d07;border:1px solid #3a361c;padding:6px 10px;border-radius:999px;color:#efeacd}

    /* Chips N√∫meros */
    .lastbar{display:flex;flex-wrap:wrap;gap:8px}
    .chip{min-width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:12px;font-weight:900;border:2px solid #1a1a10;box-shadow:var(--glow)}
    .chip.green{background:rgba(0,211,126,.18);border-color:var(--chip-green);color:#ccffe9}
    .chip.red{background:rgba(255,90,90,.18);border-color:var(--chip-red);color:#ffecec}
    .chip.black{background:rgba(111,224,255,.12);border-color:var(--chip-black);color:#eaffff}

    /* Puxadores */
    .pull{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center;border:1px solid #3a361c;background:#0b0d07;border-radius:14px;padding:12px;box-shadow:var(--glow)}
    .pull .hdr{display:flex;gap:8px;align-items:center}
    .pull .hdr b{color:var(--gold-neon);text-shadow:var(--glow)}
    .pull .meta{font-size:12px;color:#d6ce98}
    .pull .actions .btn{min-width:90px}

    .stat{display:inline-flex;gap:6px;align-items:center;padding:6px 10px;border:1px solid #3a361c;border-radius:999px;background:#0b0d07;box-shadow:var(--glow)}
    .stat b{color:var(--gold-neon)}
  </style>
</head>
<body>

  <!-- ===== NAV ===== -->
  <nav>
    <div class="row">
      <a class="brand" href="index.html" title="SC TIPS ‚Ä¢ Home">
        <video src="assets/media/logo-animated.mp4" autoplay muted loop playsinline poster="assets/img/branding/logo-static.png"></video>
        <span><b>SC TIPS</b><small>FASCOR ‚Ä¢ VIP</small></span>
      </a>
      <div class="menu" id="mainMenu">
        <a href="index.html" data-page="home">Home</a>
        <a href="estrategias.html" data-page="estrategias">Estrat√©gias</a>
        <a href="matrix-premium.html" data-page="matrix">Matrix Premium</a>
        <a class="active" href="puxadores.html" data-page="puxadores">Puxadores Live</a>
        <a href="contato.html" data-page="contato">Contato</a>
      </div>
    </div>
  </nav>

  <div class="wrap">
    <h1>üõ∞Ô∏è Puxadores Live ‚Äî Tema FASCOR (Gold Neon)</h1>

    <!-- ===== CONSOLE ===== -->
    <section class="console" role="region" aria-label="Console e Logs">
      <h3>üñ•Ô∏è Console</h3>
      <div class="row">
        <button class="btn dark" id="btnClear">üßπ Limpar</button>
        <button class="btn dark" id="btnExport">üìÑ Exportar TXT</button>
        <button class="btn dark" id="btnCSV">üìä Exportar CSV</button>
        <button class="btn ghost" id="btnSounds">üîä Sons: <span id="sndState">off</span></button>
      </div>
      <div class="row" style="margin-top:8px">
        <input id="logFilter" type="text" placeholder="üîç Pesquisar logs (mesa, dealer, n¬∫, Evolution/Pragmatic)">
        <span class="pill"><input type="checkbox" id="flt-sys" checked> SYS</span>
        <span class="pill"><input type="checkbox" id="flt-hit" checked> HIT</span>
        <span class="pill"><input type="checkbox" id="flt-miss" checked> MISS</span>
      </div>
      <div class="loglist" id="loglist"></div>
    </section>

    <div class="grid">
      <!-- ===== LADO ESQUERDO: Mesas / Seguidor ===== -->
      <section class="card">
        <h3>üß≤ Seguir Mesas (Puxadores)</h3>

        <!-- Conex√£o WS por mesa -->
        <div class="row" style="margin-bottom:8px">
          <input id="wsUrl" type="url" placeholder="URL WS da mesa (Evolution/Pragmatic)">
          <button class="btn small dark" id="btnMask">üôà Mascarar</button>
          <button class="btn small dark" id="btnCopyUrl">üìã Copiar</button>
          <button class="btn small" id="btnConnect">üîå Conectar</button>
          <button class="btn small dark" id="btnDisconnect" disabled>‚ùå Desconectar</button>
        </div>
        <div class="row">
          <input id="roomName" type="text" placeholder="Nome da Mesa / Dealer">
          <input id="simNumber" type="number" min="0" max="36" placeholder="Simular n¬∫ (0-36)">
          <button class="btn small" id="btnSim">üéØ Simular</button>
          <button class="btn small dark" id="btnCopyRoom">üìã Copiar mesa</button>
        </div>

        <div class="row" style="margin:10px 0">
          <span class="stat">Mesa: <b id="statRoom">‚Äî</b></span>
          <span class="stat">WS: <b id="wsstat">offline</b></span>
          <span class="stat">Contagem: <b id="pullCount">0</b></span>
          <span class="stat">Hits: <b id="hitCount">0</b></span>
        </div>

        <h2>üî¢ √öltimos n√∫meros</h2>
        <div class="lastbar" id="lastbar"></div>

        <div class="row" style="margin-top:10px">
          <button class="btn small" id="btnClearNums">üßπ Limpar n√∫meros</button>
          <button class="btn small" id="btnPing">üì° Broadcast Ping</button>
          <button class="btn small dark" id="btnCSVNums">üìä Exportar CSV</button>
        </div>

        <div class="tip" style="margin-top:8px">Tokens da URL s√£o ocultos. Eventos aceitos: <code>roulette.winSpots</code> (Evolution), <code>spin_result/result</code> (Pragmatic) e gen√©ricos com <code>number</code>.</div>
      </section>

      <!-- ===== LADO DIREITO: Plataformas / Lista de salas ===== -->
      <section class="card">
        <h3>üé≤ Plataformas & Salas</h3>
        <div class="row" id="platforms"></div>

        <h2>Salas (exemplo)</h2>
        <div id="rooms" class="list" style="display:grid;gap:10px"></div>
        <div class="tip" style="margin-top:8px">Clique numa sala para preencher a Mesa e seguir rapidamente.</div>
      </section>
    </div>
  </div>

  <footer style="text-align:center;margin:28px 0 12px;color:#c9c29b;font-size:13px">
    ¬© 2025 <b>SC TIPS</b> ‚Äî Tema FASCOR Gold Neon.
  </footer>

  <!-- ===== √ÅUDIO ===== -->
  <audio id="snd-green" src="assets/audio/green.mp3" preload="auto"></audio>
  <audio id="snd-red"   src="assets/audio/red.mp3"   preload="auto"></audio>
  <audio id="snd-alert" src="assets/audio/alerta.mp3" preload="auto"></audio>
  <audio id="snd-click" src="assets/audio/click.mp3"  preload="auto"></audio>

  <!-- ===== JS ===== -->
  <script>
  /* ========= Helpers & Console ========= */
  const $ = s => document.querySelector(s);
  const loglist = $("#loglist");
  const filters = { sys:true, hit:true, miss:true, text:"" };
  function capLogs(max=800){ while(loglist.children.length>max){ loglist.removeChild(loglist.firstChild); } }
  function log(msg, cls="sys"){
    if(cls!=="warn" && !filters[cls]) return;
    if(filters.text && !String(msg).toLowerCase().includes(filters.text)) return;
    const d=document.createElement("div");
    d.className="log "+cls;
    d.textContent=`[${new Date().toLocaleTimeString()}] ${msg}`;
    loglist.appendChild(d); loglist.scrollTop=loglist.scrollHeight; capLogs();
  }
  $("#btnClear").onclick=()=>loglist.innerHTML="";
  $("#btnExport").onclick=()=>{
    const txt=[...loglist.children].map(x=>x.textContent).join("\n");
    const a=document.createElement("a"); a.href=URL.createObjectURL(new Blob([txt],{type:"text/plain"}));
    a.download="puxadores_logs.txt"; a.click(); URL.revokeObjectURL(a.href);
  };
  $("#btnCSV").onclick=()=>exportCSV();
  $("#flt-sys").onchange=e=>filters.sys=e.target.checked;
  $("#flt-hit").onchange=e=>filters.hit=e.target.checked;
  $("#flt-miss").onchange=e=>filters.miss=e.target.checked;
  $("#logFilter").oninput=e=>filters.text=(e.target.value||"").toLowerCase();

  /* ========= Sons ========= */
  let soundsOn=false; const sndState=$("#sndState");
  $("#btnSounds").onclick=()=>{ soundsOn=!soundsOn; sndState.textContent=soundsOn?"on":"off"; try{$("#snd-click").play().catch(()=>{});}catch(e){} };
  function play(id){ if(!soundsOn) return; const el=document.getElementById(id); if(el){ el.currentTime=0; el.play().catch(()=>{});} }

  /* ========= Chips √öltimos N√∫meros ========= */
  const lastbar = $("#lastbar");
  const redSet = new Set([1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36]);
  function colorOf(n){ return n===0?"green":(redSet.has(n)?"red":"black"); }
  let recent = []; // m√°x 20
  function pushNumber(n){
    recent.unshift(n); if(recent.length>20) recent.pop(); renderChips();
    $("#pullCount").textContent = String(Number($("#pullCount").textContent||"0")+1);
    if(n===lastGood) $("#hitCount").textContent = String(Number($("#hitCount").textContent||"0")+1);
  }
  function renderChips(){
    lastbar.innerHTML=""; recent.forEach(n=>{
      const c=document.createElement("div");
      c.className="chip "+colorOf(n); c.textContent=n;
      c.title="Repetir "+n; c.onclick=()=>handleIncoming({number:n, source:"chip"});
      lastbar.appendChild(c);
    });
  }
  function clearNums(){ recent=[]; renderChips(); $("#pullCount").textContent="0"; $("#hitCount").textContent="0"; }
  $("#btnClearNums").onclick=()=>{ clearNums(); log("üßπ √öltimos n√∫meros limpos","sys"); };
  function exportCSV(){
    const header="timestamp,numero\n"; const now=new Date().toISOString();
    const rows=recent.map(n=>`${now},${n}`).join("\n");
    const a=document.createElement("a");
    a.href=URL.createObjectURL(new Blob([header+rows+"\n"],{type:"text/csv"}));
    a.download="puxadores_last_numbers.csv"; a.click(); URL.revokeObjectURL(a.href);
  }
  $("#btnCSVNums").onclick=exportCSV;

  /* ========= Plataformas + sparkline ========= */
  const plats=[{name:"Evolution",icon:"üé°"},{name:"Pragmatic",icon:"üé∞"},{name:"Donald",icon:"üé≤"},{name:"BBTips",icon:"üìà"},{name:"Lucky",icon:"üçÄ"},{name:"Engine",icon:"üß†"}];
  const platBox=$("#platforms"); let activePlatform=localStorage.getItem("px_active_platform")||"Engine";
  function renderPlatforms(){
    platBox.innerHTML="";
    plats.forEach(p=>{
      const wrap=document.createElement("div");
      wrap.className="pull"; wrap.style="grid-template-columns:auto auto;gap:12px";
      wrap.innerHTML=`<div class="hdr"><b>${p.icon} ${p.name}</b><span class="meta" id="lat_${p.name}">‚Äîms</span></div>
                      <canvas class="spark" id="sp_${p.name}" width="150" height="40"></canvas>`;
      wrap.onclick=()=>{ activePlatform=p.name; localStorage.setItem("px_active_platform",activePlatform); log("Plataforma ativa: "+activePlatform,"sys"); };
      platBox.appendChild(wrap);
    });
  }
  renderPlatforms();
  const sparkData={}; plats.forEach(p=>sparkData[p.name]=[]);
  function pushSpark(name,v){ const arr=sparkData[name]; arr.push(v); if(arr.length>30) arr.shift();
    const cv=$("#sp_"+name), ctx=cv.getContext("2d"); ctx.clearRect(0,0,cv.width,cv.height);
    ctx.beginPath(); ctx.moveTo(0,cv.height-(arr[0]||0));
    arr.forEach((val,i)=>ctx.lineTo(i*5, cv.height - Math.min(cv.height-2,val)));
    ctx.strokeStyle="#38ff8b"; ctx.lineWidth=2; ctx.stroke();
  }
  setInterval(()=>{ plats.forEach(p=>{ const v=6+Math.floor(Math.random()*20); $("#lat_"+p.name).textContent=v+"ms"; pushSpark(p.name, Math.min(38,v)); }); }, 1200);

  /* ========= Salas exemplo ========= */
  const rooms = [
    { id:"evo_auto_roulette",   name:"Evolution ‚Ä¢ Auto Roulette", dealer:"Auto",     platform:"Evolution" },
    { id:"evo_speed_roulette",  name:"Evolution ‚Ä¢ Speed Roulette",dealer:"V√°rios",   platform:"Evolution" },
    { id:"prag_auto_roulette",  name:"Pragmatic ‚Ä¢ Auto Roulette", dealer:"Auto",     platform:"Pragmatic" },
    { id:"prag_mega_roulette",  name:"Pragmatic ‚Ä¢ Mega Roulette", dealer:"V√°rios",   platform:"Pragmatic" }
  ];
  const roomsBox=$("#rooms");
  rooms.forEach(r=>{
    const el=document.createElement("div");
    el.className="pull";
    el.innerHTML=`
      <div class="hdr"><b>${r.name}</b></div>
      <div class="actions row">
        <button class="btn small" data-follow="${r.id}">Seguir</button>
      </div>
      <div style="grid-column:1/-1" class="meta">Dealer: ${r.dealer} ‚Ä¢ Plataforma: ${r.platform}</div>`;
    roomsBox.appendChild(el);
  });
  roomsBox.addEventListener("click",(e)=>{
    const btn=e.target.closest("[data-follow]"); if(!btn) return;
    const id=btn.getAttribute("data-follow");
    const r=rooms.find(x=>x.id===id); if(!r) return;
    $("#roomName").value = r.name;
    $("#statRoom").textContent = r.name;
    activePlatform = r.platform;
    localStorage.setItem("px_active_platform",activePlatform);
    log("Mesa selecionada: "+r.name,"sys");
  });

  /* ========= WS por mesa ========= */
  let ws=null, masked=false;
  function sanitizeWsUrl(u){ try{ const url=new URL(u); ["EVOSESSIONID","JSESSIONID","videoToken","token","auth","session","videoSessionId","client_version"].forEach(k=>url.searchParams.delete(k)); return url.origin+url.pathname+(url.search?`?${url.searchParams.toString()}`:""); } catch(_){ return (u||"").replace(/(EVOSESSIONID|JSESSIONID|videoToken|token)=([^&]+)/gi,"$1=‚Ä¢‚Ä¢‚Ä¢"); } }
  function setConnUI(b){ $("#btnConnect").disabled=b; $("#btnDisconnect").disabled=!b; $("#wsstat").textContent=b?"online":"offline"; }
  $("#btnMask").onclick=()=>{ masked=!masked; const el=$("#wsUrl");
    if(masked){ el.dataset.real=el.value; if(el.value){ try{const u=new URL(el.value); el.value=`${u.protocol}//${u.host}/‚Ä¢‚Ä¢‚Ä¢`;}catch(_){el.value="‚Ä¢‚Ä¢‚Ä¢"} } }
    else { if(el.dataset.real) el.value=el.dataset.real; }
  };
  $("#btnCopyUrl").onclick=()=>{ const el=$("#wsUrl"); const v=(masked && el.dataset.real)?el.dataset.real:el.value; navigator.clipboard.writeText(v||""); log("URL copiada","sys"); };
  $("#btnCopyRoom").onclick=()=>{ const v=$("#roomName").value||""; navigator.clipboard.writeText(v); log("Mesa copiada","sys"); };

  $("#btnConnect").onclick=()=>{
    const raw=($("#wsUrl").dataset.real||$("#wsUrl").value||"").trim();
    if(!raw){ log("Cole a URL do WebSocket da mesa.","warn"); return; }
    const safe=sanitizeWsUrl(raw);
    try{
      ws=new WebSocket(raw);
      ws.onopen =()=>{ setConnUI(true); log("‚úÖ Conectado mesa: "+($("#roomName").value||"‚Äî")+" ‚Ä¢ "+safe,"sys"); };
      ws.onclose=()=>{ setConnUI(false); log("‚ùå WS encerrado","warn"); };
      ws.onerror=e=>log("‚ö†Ô∏è WS erro: "+(e?.message||"desconhecido"),"warn");
      ws.onmessage=ev=>{ let data=ev.data; try{ data=JSON.parse(ev.data);}catch(_){ } handleIncoming(data); };
    }catch(e){ log("‚ö†Ô∏è Falha abrir WS: "+e.message,"warn"); }
  };
  $("#btnDisconnect").onclick=()=>{ if(ws){ try{ws.close()}catch(_){}} ws=null; setConnUI(false); log("üîå Conex√£o encerrada","warn"); };

  /* ========= BroadcastChannel / postMessage ========= */
  const bc = new BroadcastChannel("matrix-channel");
  $("#btnPing").onclick=()=>{ bc.postMessage({type:"ping", at:Date.now(), from:"puxadores"}); log("üì° Ping BC enviado","sys"); };
  bc.onmessage = ev => { log("üì° BC: "+JSON.stringify(ev.data),"sys"); if(ev.data?.type==="entries"){ play("snd-alert"); } };
  window.addEventListener("message", ev=>{ if(ev.data?.type==="matrix"){ log("üí¨ postMessage: "+JSON.stringify(ev.data.payload),"sys"); } });

  /* ========= Handler de eventos ========= */
  let lastGood=null, lastAt=0;
  function handleIncoming(payload){
    let n=null, platform=activePlatform;
    if(payload?.type==="roulette.winSpots"){ n=payload?.args?.result?.[0]?.number ?? null; platform="Evolution"; }
    if(n==null && (payload?.type==="spin_result" || payload?.type==="result" || payload?.winningNumber!=null)){ n=payload?.result ?? payload?.winningNumber ?? null; platform="Pragmatic"; }
    if(n==null && typeof payload?.number==="number"){ n=payload.number; }

    if(typeof n!=="number" || n<0 || n>36){
      log("Msg (sem n¬∫): "+(typeof payload==="string"?payload:JSON.stringify(payload)),"sys");
      return;
    }
    const now=performance.now();
    if(lastGood===n && (now-lastAt)<1200){ log(`(dedupe) n¬∫ ${n} ignorado`, "sys"); return; }
    lastGood=n; lastAt=now;

    pushNumber(n);
    const col=colorOf(n);
    const room=$("#roomName").value || "Mesa";
    log(`üéØ ${room}: n¬∫ ${n} (${col}) ‚Ä¢ ${platform}`,"hit");
    play("snd-green");
  }

  /* ========= Simula√ß√£o ========= */
  $("#btnSim").onclick=()=>{
    const v=parseInt($("#simNumber").value,10);
    if(Number.isFinite(v)&&v>=0&&v<=36){ handleIncoming({number:v, source:"sim"}); }
    else { log("Informe n¬∫ 0‚Äì36","warn"); play("snd-red"); }
  };

  /* ========= Menu ativo / blindagem ========= */
  (function(){
    const menu = document.getElementById('mainMenu');
    if (!menu) return;
    const map = {
      home:"index.html", estrategias:"estrategias.html", matrix:"matrix-premium.html", puxadores:"puxadores.html", contato:"contato.html"
    };
    menu.querySelectorAll('a[data-page]').forEach(a=>{
      const key=a.getAttribute('data-page');
      if(map[key] && a.getAttribute('href')!==map[key]) a.setAttribute('href', map[key]);
      a.onclick=null;
    });
    const path=(location.pathname.split('/').pop()||'puxadores.html').toLowerCase();
    menu.querySelectorAll('a').forEach(a=>a.classList.remove('active'));
    if (path.includes('matrix-premium')) menu.querySelector('[data-page="matrix"]')?.classList.add('active');
    else if (path.includes('puxadores')) menu.querySelector('[data-page="puxadores"]')?.classList.add('active');
    else if (path.includes('contato')) menu.querySelector('[data-page="contato"]')?.classList.add('active');
    else if (path.includes('estrategias')) menu.querySelector('[data-page="estrategias"]')?.classList.add('active');
    else menu.querySelector('[data-page="home"]')?.classList.add('active');
  })();

  /* ========= Seguran√ßa b√°sica ========= */
  window.addEventListener('error', (e)=>{
    const msg = (e?.error && e.error.stack) ? e.error.stack : (e?.message || 'Erro desconhecido');
    try { log("üõë ERRO: " + msg, "miss"); } catch(_) {}
  });
  </script>
</body>
</html>
